# Artifacts

The artifacts panel displays interactive content created by the AI (HTML, SVG, Markdown, etc.) in a sandboxed environment.

## Structure

### Desktop (Side Panel)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Artifacts                                        [â†—ï¸] [Ã—]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚  â”‚ Tab 1  â”‚ â”‚ Tab 2  â”‚ â”‚ Tab 3  â”‚                           â”‚
â”‚  â”‚ active â”‚ â”‚        â”‚ â”‚        â”‚                           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚                                                              â”‚
â”‚                      [Artifact Content]                      â”‚
â”‚                                                              â”‚
â”‚                                                              â”‚
â”‚                                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  chart.html Â· HTML Â· v2        [ğŸ“‹ Copy] [â¬‡ï¸ Download] [ğŸ—‘ï¸] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Mobile (Fullscreen Overlay)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â† Artifacts                   [Ã—]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ Tab 1 â”‚ â”‚ Tab 2 â”‚ â”‚ Tab 3 â”‚ â†’   â”‚ â† Horizontal scroll
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚                                     â”‚
â”‚        [Artifact Content]           â”‚
â”‚                                     â”‚
â”‚                                     â”‚
â”‚                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  chart.html                         â”‚
â”‚  HTML Â· Version 2                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ [ğŸ“‹ Copy] [â¬‡ï¸ Download] [ğŸ—‘ï¸] â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Components

### Artifacts Panel

```typescript
interface ArtifactsPanelProps {
  artifacts: Artifact[];
  activeArtifactId: string | null;
  onSelect: (id: string) => void;
  onClose: () => void;
  onFullscreen: () => void;
  onCopy: (id: string) => void;
  onDownload: (id: string) => void;
  onDelete: (id: string) => void;
}

interface Artifact {
  id: string;
  filename: string;
  type: ArtifactType;
  content: string;
  version: number;
  createdAt: string;
  updatedAt: string;
}

type ArtifactType = 
  | 'html'
  | 'svg'
  | 'markdown'
  | 'text'
  | 'json'
  | 'image'
  | 'pdf'
  | 'docx'
  | 'xlsx';
```

### Tab Bar

```typescript
interface ArtifactTabsProps {
  artifacts: Artifact[];
  activeId: string | null;
  onSelect: (id: string) => void;
}
```

**Tab appearance:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ¨ chart.html    Ã—  â”‚ â† Type icon + filename + close
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Type icons:**
| Type | Icon |
|------|------|
| html | ğŸŒ |
| svg | ğŸ–¼ï¸ |
| markdown | ğŸ“ |
| text | ğŸ“„ |
| json | ğŸ“Š |
| image | ğŸ–¼ï¸ |
| pdf | ğŸ“• |
| docx | ğŸ“˜ |
| xlsx | ğŸ“— |

**Behavior:**
- Horizontal scroll when many tabs
- Active tab highlighted
- Close button on hover (or always on mobile)
- Drag to reorder (future)

### Content Viewer

```typescript
interface ArtifactViewerProps {
  artifact: Artifact;
  onLoad: () => void;
  onError: (error: string) => void;
}
```

**Rendering by type:**

| Type | Renderer |
|------|----------|
| html | Sandboxed iframe |
| svg | Inline SVG or iframe |
| markdown | Rendered markdown |
| text | Pre-formatted text |
| json | Syntax-highlighted JSON with collapse |
| image | `<img>` tag |
| pdf | PDF viewer or download link |
| docx/xlsx | Preview or download link |

### HTML Sandbox

```typescript
interface SandboxedIframeProps {
  html: string;
  sandboxUrl: string;  // For CSP
  onMessage: (data: unknown) => void;
}
```

**Sandbox attributes:**
```html
<iframe
  sandbox="allow-scripts allow-same-origin"
  src={sandboxUrl}
  title="Artifact preview"
/>
```

**Security:**
- Content loaded via srcdoc or blob URL
- No access to parent window
- No network requests (unless explicitly allowed)
- postMessage for communication

### Footer Bar

```typescript
interface ArtifactFooterProps {
  artifact: Artifact;
  onCopy: () => void;
  onDownload: () => void;
  onDelete: () => void;
}
```

**Layout:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  chart.html Â· HTML Â· Version 2     [ğŸ“‹] [â¬‡ï¸] [ğŸ—‘ï¸]          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Actions:**
- **Copy**: Copy source code to clipboard
- **Download**: Save as file
- **Delete**: Remove artifact (with confirmation)

## Artifact Lifecycle

### Creation

```typescript
// Tool creates artifact
{
  type: 'toolResult',
  toolName: 'artifacts',
  content: [{
    type: 'text',
    text: 'Created chart.html'
  }],
  details: {
    action: 'create',
    filename: 'chart.html',
    artifactType: 'html',
    content: '<html>...</html>'
  }
}
```

**UI behavior:**
1. Add artifact to panel
2. Open panel if closed
3. Switch to new artifact tab
4. Show creation toast

### Update

```typescript
// Tool updates artifact
{
  details: {
    action: 'update',
    filename: 'chart.html',
    content: '<html><!-- updated --></html>'
  }
}
```

**UI behavior:**
1. Increment version
2. Refresh content viewer
3. Show update toast (optional)

### Deletion

```typescript
// Tool deletes artifact
{
  details: {
    action: 'delete',
    filename: 'chart.html'
  }
}
```

**UI behavior:**
1. Show confirmation dialog
2. Remove from tabs
3. Switch to next artifact or close panel

## Fullscreen Mode

```typescript
interface FullscreenArtifactProps {
  artifact: Artifact;
  onClose: () => void;
  onPrevious: () => void;
  onNext: () => void;
}
```

**Layout:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â† Back   chart.html                                    [ğŸ“‹] [â¬‡ï¸] [Ã—]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚                                                                          â”‚
â”‚                                                                          â”‚
â”‚                           [Full Viewport Content]                        â”‚
â”‚                                                                          â”‚
â”‚                                                                          â”‚
â”‚                                                                          â”‚
â”‚                                                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [â† Previous]                                              [Next â†’]     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Triggers:**
- Fullscreen button (â†—ï¸) in panel header
- Double-click on artifact content
- Swipe up on mobile

**Exit:**
- Close button (Ã—)
- Escape key
- Swipe down on mobile

## Version History (Future)

```typescript
interface ArtifactVersionsProps {
  artifact: Artifact;
  versions: ArtifactVersion[];
  onSelectVersion: (version: number) => void;
}

interface ArtifactVersion {
  version: number;
  content: string;
  timestamp: string;
}
```

**Dropdown in footer:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Version 3 (current)   â–¾ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â—‹ Version 3 - 2:34 PM   â”‚
â”‚ â—‹ Version 2 - 2:30 PM   â”‚
â”‚ â—‹ Version 1 - 2:25 PM   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Markdown Rendering

```typescript
interface MarkdownViewerProps {
  content: string;
  onLinkClick: (url: string) => void;
}
```

**Features:**
- GitHub-flavored markdown
- Syntax-highlighted code blocks
- Tables
- Task lists
- Embedded images (base64 or URL)
- Math rendering (KaTeX) - optional

## JSON Viewer

```typescript
interface JsonViewerProps {
  content: string;
  collapsed: boolean;
  onToggle: () => void;
}
```

**Features:**
- Syntax highlighting
- Collapsible nodes
- Copy path on click
- Search within JSON

## Error Handling

### Load Error

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                              â”‚
â”‚                          âš ï¸                                  â”‚
â”‚                                                              â”‚
â”‚           Failed to load artifact                            â”‚
â”‚                                                              â”‚
â”‚   The content could not be rendered.                        â”‚
â”‚   This may be due to invalid HTML or security restrictions. â”‚
â”‚                                                              â”‚
â”‚   [View Source] [Download]                                  â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Empty State

When no artifacts exist:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                              â”‚
â”‚                          ğŸ¨                                  â”‚
â”‚                                                              â”‚
â”‚                   No artifacts yet                           â”‚
â”‚                                                              â”‚
â”‚   Ask the AI to create HTML, SVG, or other                  â”‚
â”‚   interactive content and it will appear here.              â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Gestures (Mobile)

| Gesture | Action |
|---------|--------|
| Swipe left/right on tab | Switch artifacts |
| Swipe down from top | Close fullscreen |
| Swipe up from content | Enter fullscreen |
| Pinch | Zoom (for images/HTML) |
| Double tap | Toggle fullscreen |

## Accessibility

- **ARIA labels**: "Artifact viewer", "Artifact tabs"
- **Keyboard navigation**: Tab through artifacts, Enter to select
- **Focus trap**: In fullscreen mode
- **Alt text**: For images and icons
- **Screen reader**: Announce artifact changes

## Performance

- **Lazy rendering**: Only render visible artifact
- **Debounced updates**: Don't re-render during rapid updates
- **Blob URLs**: For large content
- **Cleanup**: Revoke blob URLs on unmount
